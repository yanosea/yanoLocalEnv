#!/bin/bash
# Update pkglist
echo -e "\e[33;1m
Update pkglist!
\e[m"

## Update Pacman Package List
if [ "$OS" = "Linux" ]; then
    paru -Qq > $HOME/work/pkglist/pacmanpkglist.txt
fi

## Update Brew Package List
if [ "$OS" = "Linux" ]; then
    brew leaves > $HOME/work/pkglist/archbrewpkglist.txt
elif [ "$OS" = "Darwin" ]; then
    brew leaves > $HOME/work/pkglist/macbrewpkglist.txt
    brew list --cask -1 >> $HOME/work/pkglist/macbrewpkglist.txt
fi

## Update Go Package List
rm $HOME/work/pkglist/gopkglist.txt
for file in ${GOPATH}/bin/*; do
    if [[ -f "$file" ]]; then
        pkg="$(go version -m "$file" | head -n2 | tail -n1 | awk '{print $2}')"
        echo "${pkg}@latest" >> $HOME/work/pkglist/gopkglist.txt
    fi
done

## Update GitHub Package List
ghq list > $HOME/work/pkglist/ghpkglist.txt

## Update cargo Package List
cargo install --list | sed -e 's/ .*//g' | tr -s '\n' > $HOME/work/pkglist/cargopkglist.txt

## Update npm Package List
volta list all | sed -n 's/^package \(@\{0,1\}[^@]*\).*/\1/p' > $HOME/work/pkglist/npmpkglist.txt

## Update pip Package List
pip freeze | sed -e 's/==.*//g' > $HOME/work/pkglist/pippkglist.txt
